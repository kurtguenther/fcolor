<!DOCTYPE html>
<html lang="en" class="no-js">
    <head>
	<meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
        <title>Animated Responsive Image Grid</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
        <meta name="description" content="Animated Responsive Image Grid - Cycling through a set of images in a responsive grid." />
        <meta name="keywords" content="grid, images, thumbnails, responsive, css3, jquery, javascript, random, transition, 3d, perspective" />
        <meta name="author" content="Codrops" />
        <link rel="shortcut icon" href="../favicon.ico"> 
        <link rel="stylesheet" type="text/css" href="css/demo.css" />
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<script type="text/javascript" src="js/modernizr.custom.26633.js"></script> 
		<noscript>
			<link rel="stylesheet" type="text/css" href="css/fallback.css" />
		</noscript>
		<!--[if lt IE 9]>
			<link rel="stylesheet" type="text/css" href="css/fallback.css" />
		<![endif]-->
	            </head>
    <body>
	    <div class="container">
			
	    			<!-- Codrops top bar -->
	                <div class="codrops-top">
	                    <a href="http://tympanus.net/Tutorials/PhotoBoothStripsLightbox/">
	                        <strong>Colors: </strong>This is the color of your social network.
	                    </a>
	                    <span class="right">
	    		
	                    </span>
	                    <div class="clr"></div>
	                </div><!--/ Codrops top bar -->
			
	    			<section class="main">

	    				<div id="ri-grid" class="ri-grid ri-grid-size-3">
	    					<img class="ri-loading-image" src="/images/loading.gif"/>
	    					
					<ul id="ri-ul">
						
						
					</ul>
									</div>
				
									<header class="codrops-header-special">
			
									</header>

								</section>
			
			<div id="facebook_container">
			</div>
        </div>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
		

	
		<script type="text/javascript" src="js/jquery.gridrotator.js"></script>
		<script type="text/javascript">	

	
	
		</script>
		<script type="text/javascript">
		var do_stuff = function() {    	
			
				$('.profile-image.facebook-image').each(function(){
					// rgb=getAverageRGB($(this)[0]);
					// 					console.log(rgb);
					// 					d='<div class="tile" id="tile-' + $(this).attr('id') + '" style="width:100%; height: 100%; background-color:rgb(' + rgb.r + ',' + rgb.g + ',' + rgb.b +');"></div>';
					// 					i='<li><a href="#"><span class="profile-name">'+ $(this).attr('data-name') + '</span><img id='+ $(this).attr('id') +' class="profile-image" src="'+ $(this).attr('data-image-url') +'"/></a>'+d+'</li>';
					// 					
					// 					//$(this).parent().append(d);
					// 					$('#ri-ul').append(i);
				});
				
				
				$( '#ri-grid' ).gridrotator( {
									rows : 4,
									columns : 8,
									maxStep : 2,
									interval : 2000,
									w1024 : {
										rows : 4,
										columns : 8
									},
									w768 : {
										rows : 4,
										columns : 8
									},
									w480 : {
										rows : 4,
										columns : 8
									},
									w320 : {
										rows : 4,
										columns : 8
									},
									w240 : {
										rows : 4,
										columns : 8
									},
								} );
			
							
							// setInterval(function(){
							// 	$('.tile').each(function(index,ui){
							// 	    $(this).delay(index*50).fadeIn(function(){
							// 	        $('#' + $(this).attr('id')).toggle();
							// 	    });
							// 	});
							// },5000);
								
							

							 							
			
		};
		
		$(document).ready(function(){
			//Set up rotator
			$( '#ri-grid' ).gridrotator( {
								rows : 4,
								columns : 8,
								maxStep : 2,
								interval : 2000,
								w1024 : {
									rows : 5,
									columns : 6
								},
								w768 : {
									rows : 5,
									columns : 5
								},
								w480 : {
									rows : 6,
									columns : 4
								},
								w320 : {
									rows : 7,
									columns : 4
								},
								w240 : {
									rows : 7,
									columns : 3
								},
							} );
		});
		</script>
    </body>
</html>	

<div id="fb-root"></div>
</body>
<script>
  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : '277386932393277', // App ID from the App Dashboard
      status     : true, // check the login status upon init?
      cookie     : true, // set sessions cookies to allow your server to access the session?
      xfbml      : true  // parse XFBML tags on this page?
    });

    // Additional initialization code such as adding Event Listeners goes here
    // *** here is my code ***
    if (typeof facebookInit == 'function') {
        facebookInit();
    }
  };

  // Load the SDK's source Asynchronously
  // Note that the debug version is being actively developed and might 
  // contain some type checks that are overly strict. 
  // Please report such bugs using the bugs tool.
  (function(d, debug){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
     ref.parentNode.insertBefore(js, ref);
   }(document, /*debug*/ false));
   
   
   function facebookInit(){
	   
	   FB.login(function(response) {
	      if (response.authResponse) {
	        var access_token =   FB.getAuthResponse()['accessToken'];

			//check that we're in.
	        console.log('Access Token = '+ access_token);
	        FB.api('/me', function(response) {
	        console.log('Good to see you, ' + response.name + '.');
	        console.log('We are in.');	
	        });
	
	
			FB.api('/me/friends', function(response)
			{
				//Let's just do up to 20 for now
				var PAGE_LIMIT = 32;
				var count = response.data.length;
				var page = Math.min(count, PAGE_LIMIT);
				

				var facebook_container = $('#facebook_container');
				for(var i = 0; i<page; i++)
				{
					var profile_id = response.data[i]['id'];
					
					if(profile_id && profile_id != '')
					{
						var img = $('<img class="profile-image facebook-image"/>');
						img.attr('data-name', response.data[i]['name']);
						img.attr('data-image-url', 'http://graph.facebook.com/' + profile_id + '/picture?width=100&height=100');						
						
						img.load(function(img){
							console.log(this);
							
							rgb=getAverageRGB($(this)[0]);
							console.log(rgb);
							d='<div class="tile" id="tile-' + $(this).attr('id') + '" style="width:100%; height: 100%; background-color:rgb(' + rgb.r + ',' + rgb.g + ',' + rgb.b +');"></div>';
							i='<li><a href="#"><span class="profile-name">'+ $(this).attr('data-name') + '</span><img id='+ $(this).attr('id') +' class="profile-image" src="'+ $(this).attr('data-image-url') +'"/></a>'+d+'</li>';

							//$(this).parent().append(d);
							$('#ri-ul').append(i);
							
							$( '#ri-grid' ).gridrotator( {
												rows : 4,
												columns : 8,
												maxStep : 2,
												interval : 2000,
												w1024 : {
													rows : 4,
													columns : 8
												},
												w768 : {
													rows : 4,
													columns : 8
												},
												w480 : {
													rows : 4,
													columns : 8
												},
												w320 : {
													rows : 4,
													columns : 8
												},
												w240 : {
													rows : 4,
													columns : 8
												},
											} );
						})
					}
					else
					{
						console.log('skipping user:'+ response.data[i])
					}
					
					img.attr('src', '/get/img/?img_url=' + escape('http://graph.facebook.com/' + profile_id + '/picture?width=100&height=100'));
					facebook_container.append(img);
				}
			
			});
	
	      } else {
	        console.log('User cancelled login or did not fully authorize.');
	      }
	    }, {scope: ''});
	   
   	
   }
   
   function getAverageRGB(imgEl) {

       var blockSize = 5, // only visit every 5 pixels
           defaultRGB = {r:0,g:0,b:0}, // for non-supporting envs
           canvas = document.createElement('canvas'),
           context = canvas.getContext && canvas.getContext('2d'),
           data, width, height,
           i = -4,
           length,
           rgb = {r:0,g:0,b:0},
           count = 0;

       if (!context) {
		   alert('No context');
           return defaultRGB;
       }

       height = canvas.height = imgEl.naturalHeight || imgEl.offsetHeight || imgEl.height;
       width = canvas.width = imgEl.naturalWidth || imgEl.offsetWidth || imgEl.width;

       context.drawImage(imgEl, 0, 0);

       try {
           data = context.getImageData(0, 0, width, height);
       } catch(e) {
           /* security error, img on diff domain */
		   alert(e);
           return defaultRGB;
       }

       length = data.data.length;

       while ( (i += blockSize * 4) < length ) {
           ++count;
           rgb.r += data.data[i];
           rgb.g += data.data[i+1];
           rgb.b += data.data[i+2];
       }

       // ~~ used to floor values
       rgb.r = ~~(rgb.r/count);
       rgb.g = ~~(rgb.g/count);
       rgb.b = ~~(rgb.b/count);

       return rgb;

   }
</script>




</html>


<!-- access_token=253746221427724|iVqkc0zTVbgREQBa1feW1mEqjOs


{
   "id": "100005323304018",
   "email": "test_zcabftj_user\u0040tfbnw.net",
   "access_token": "AAADmxZBVkLAwBAECQ6ZClqSYP281C8DBdV6bSlc9ZBEEbxtYP1ZAKC6NNoB7piXm84yicNP9M8q0aPjX5Xi5GOZA7NUUPBqeR6qMfgqlEMDXtVAzguDT6",
   "login_url": "https://www.facebook.com/platform/test_account_login.php?user_id=100005323304018&n=8B79POE36XogelF",
   "password": "429232152"
}

-->